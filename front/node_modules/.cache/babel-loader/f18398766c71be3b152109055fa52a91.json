{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\erika\\\\Desktop\\\\proyectos\\\\Casa\\\\distribuidora\\\\front\\\\src\\\\Components\\\\Home\\\\Exportacion\\\\VentaProductosFecha.js\";\nimport React from \"react\";\nimport ReactDOM from 'react-dom';\nimport api from '../../config/Api';\nimport \"react-tabulator/lib/css/bootstrap/tabulator_bootstrap.min.css\";\nimport { React15Tabulator } from \"react-tabulator\";\nimport axios from 'axios';\nimport moment from 'moment';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport TextField from '@material-ui/core/TextField';\nimport ExcelDownload from './exportExcel';\nconst top100Films = [{\n  title: 'Ventas',\n  codigo: 0,\n  codigoCp: 'cpVentas'\n}, {\n  title: 'Venta de productos por fecha',\n  codigo: 1,\n  codigoCp: 'cpVentaProductos'\n}, {\n  title: 'Ventas del vendedor',\n  codigo: 2,\n  codigoCp: 'cpVentaVendedor'\n}, {\n  title: 'Ventas del vendedor pagadas',\n  codigo: 3,\n  codigoCp: 'cpVentaVendedorPagadas'\n}, {\n  title: 'Ventas del vendedor inpagadas',\n  codigo: 4,\n  codigoCp: 'cpVentaVendedorInpagadas'\n}, {\n  title: 'Ventas por producto',\n  codigo: 5,\n  codigoCp: 'cpVentaProducto'\n}, {\n  title: 'Comisiones pagadas',\n  codigo: 6,\n  codigoCp: 'cpComisionPagadas'\n}, {\n  title: 'Resumen ventas',\n  codigo: 6,\n  codigoCp: 'cpResuemenVentas'\n}];\nconst data = [];\n\nclass ListaPagos extends React.Component {\n  constructor(props) {\n    super(props);\n    this.consultaVentasProducto = this.consultaVentasProducto.bind(this);\n    this.exExcelTes = this.exExcelTes.bind(this);\n    this.getOptionsSelect = this.getOptionsSelect.bind(this);\n    this.state = {\n      data: '',\n      inicio: null,\n      final: null,\n      dataSelect: [],\n      arrayIdProductos: []\n    };\n  }\n\n  change(e) {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  } //Cargamos los datos de la tabla.\n\n\n  componentDidMount() {\n    this.getProductos();\n  }\n\n  getProductos() {\n    axios.get(`${api}/api/producto`).then(res => {\n      //Validamos que el status de la respuesta de 200.\n      if (res.status === 200) {\n        let data = res.data.producto;\n        this.setState({\n          dataSelect: data\n        });\n      }\n    });\n  }\n\n  getOptionsSelect(e) {\n    let idProductos = [];\n    e.forEach(element => {\n      idProductos.push(element.id);\n    });\n    this.setState({\n      arrayIdProductos: idProductos\n    });\n  } //Insertamos los datos.\n\n\n  consultaVentasProducto() {\n    let inicio = this.state.inicio;\n    let final = this.state.final;\n    let idProductos = this.state.arrayIdProductos; //console.log(idProductos);\n\n    const data = 1;\n    this.setState({\n      data\n    }); //Realizamos la consulta con las fehcas\n\n    axios.post(`${api}/api/informes/ventasProductosFecha/${inicio}/${final}`).then(res => {\n      //Validamos que el status de la respuesta de 200.\n      if (res.status === 200) {\n        let dataVentas = res.data.ventas;\n        let newArrayDatosGrilla = [];\n        let newArrayDatosExcel2 = []; //Creamos los titulos.\n\n        let arrayTitulos = ['Fecha Documento', 'N Factura', 'Nombre Cliente', 'Tipo Factura', 'Producto', 'Codigo', 'Rut', 'Total Neto', 'IVA', 'Total'];\n        let totalNeto = 0;\n        let totalIvav = 0;\n        let totalTotal = 0;\n        let cantidadDatos = 0;\n\n        for (let i = 0; i < dataVentas.length; i++) {\n          //Convertimos la fecha \n          let newFecha = new Date(dataVentas[i]['fechaDocumento']);\n          newFecha = moment(newFecha).format('DD/MM/YYYY');\n          let newArrayDatosExcel = []; //Array para grilla\n\n          newArrayDatosGrilla.push({\n            fechaDocumento: newFecha,\n            numeroFactura: dataVentas[i]['numeroFactura'],\n            nombreCliente: dataVentas[i]['nombreCliente'],\n            nombreTipoFactura: dataVentas[i]['nombreTipoFactura'],\n            Producto: dataVentas[i]['Producto'],\n            codigo: dataVentas[i]['codigo'],\n            rut: dataVentas[i]['rut'],\n            totalNeto: dataVentas[i]['totalNeto'],\n            IVA: dataVentas[i]['IVA'],\n            total: dataVentas[i]['total']\n          }); //array para excel.\n\n          newArrayDatosExcel.push(newFecha);\n          newArrayDatosExcel.push(dataVentas[i]['numeroFactura']);\n          newArrayDatosExcel.push(dataVentas[i]['nombreCliente']);\n          newArrayDatosExcel.push(dataVentas[i]['nombreTipoFactura']);\n          newArrayDatosExcel.push(dataVentas[i]['Producto']);\n          newArrayDatosExcel.push(dataVentas[i]['codigo']);\n          newArrayDatosExcel.push(dataVentas[i]['rut']);\n          newArrayDatosExcel.push(dataVentas[i]['totalNeto']);\n          newArrayDatosExcel.push(dataVentas[i]['IVA']);\n          newArrayDatosExcel.push(dataVentas[i]['total']);\n          totalNeto += parseInt(dataVentas[i]['totalNeto'].replace('$', ''));\n          totalIvav += parseInt(dataVentas[i]['IVA'].replace('$', ''));\n          totalTotal += parseInt(dataVentas[i]['total'].replace('$', ''));\n          newArrayDatosExcel2.push(newArrayDatosExcel);\n        }\n\n        console.log(totalNeto);\n        console.log(totalIvav); //Guardamos los datos para la grilla\n\n        this.setState({\n          data: newArrayDatosGrilla\n        }); //Validamos que tenga datos.\n        //console.log(newArrayDatosExcel2.length);\n\n        let largoExcel = newArrayDatosExcel2.length;\n        console.log(largoExcel);\n\n        if (newArrayDatosExcel2.length >= 1) {\n          //Guardamos los datos para exportacion de excel.\n          let exportaDataExcel = [{\n            columns: arrayTitulos,\n            data: newArrayDatosExcel2\n          }, {\n            xSteps: 8,\n            //Columna\n            ySteps: 0,\n            //Lineo o posicion\n            columns: [\"Total\", `${totalNeto}`, `${totalIvav}`, `${totalTotal}`]\n          }];\n          console.log(exportaDataExcel);\n          this.exExcelTes(exportaDataExcel, \"Ventas\");\n        }\n      } else {}\n    });\n  }\n\n  exExcelTes(datosExport, name) {\n    ReactDOM.render( /*#__PURE__*/React.createElement(ExcelDownload, {\n      data: datosExport,\n      nombreDocument: name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 7\n      }\n    }), document.getElementById('callExcel'));\n  }\n\n  render() {\n    let filteredData = this.state.data;\n    let dataSelect = this.state.dataSelect; //Agregamos las columnas a la tabla.\n\n    const columns = [{\n      title: \"Fecha Documento\",\n      field: \"fechaDocumento\",\n      width: \"9%\"\n    }, {\n      title: \"N Factura\",\n      field: \"numeroFactura\",\n      width: \"15%\"\n    }, {\n      title: \"Nombre Cliente\",\n      field: \"nombreCliente\",\n      width: \"15%\"\n    }, {\n      title: \"Tipo Factura\",\n      field: \"nombreTipoFactura\",\n      width: \"15%\"\n    }, {\n      title: \"Producto\",\n      field: \"Producto\",\n      width: \"15%\"\n    }, {\n      title: \"Codigo\",\n      field: \"codigo\",\n      width: \"15%\"\n    }, {\n      title: \"Rut\",\n      field: \"rut\",\n      width: \"15%\"\n    }, {\n      title: \"Total Neto\",\n      field: \"totalNeto\",\n      width: \"15%\"\n    }, {\n      title: \"IVA\",\n      field: \"IVA\",\n      width: \"15%\"\n    }, {\n      title: \"Total\",\n      field: \"total\",\n      width: \"15%\"\n    }]; //Opciones de data table\n\n    const options = {\n      layout: \"id\",\n      width: \"100%\",\n      pagination: \"local\",\n      paginationSize: 10,\n      movableColumns: true,\n      persistence: {\n        sort: true,\n        filter: true,\n        columns: true\n      },\n      persistenceID: \"dataSave\"\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 21\n      }\n    }, \"Fecha de Inico\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.change(e),\n      className: \"form-control\",\n      type: \"date\",\n      name: \"inicio\",\n      value: this.state.ciudad,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 21\n      }\n    }, \"Fecha de vencimiento\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.change(e),\n      className: \"form-control\",\n      type: \"date\",\n      name: \"final\",\n      value: this.state.ciudad,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.consultaVentasProducto,\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 21\n      }\n    }, \" Consultar \"))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(React15Tabulator, {\n      columns: columns,\n      data: filteredData,\n      options: options,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"callExcel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}\n\nexport default ListaPagos;","map":{"version":3,"sources":["C:/Users/erika/Desktop/proyectos/Casa/distribuidora/front/src/Components/Home/Exportacion/VentaProductosFecha.js"],"names":["React","ReactDOM","api","React15Tabulator","axios","moment","Autocomplete","TextField","ExcelDownload","top100Films","title","codigo","codigoCp","data","ListaPagos","Component","constructor","props","consultaVentasProducto","bind","exExcelTes","getOptionsSelect","state","inicio","final","dataSelect","arrayIdProductos","change","e","setState","target","name","value","componentDidMount","getProductos","get","then","res","status","producto","idProductos","forEach","element","push","id","post","dataVentas","ventas","newArrayDatosGrilla","newArrayDatosExcel2","arrayTitulos","totalNeto","totalIvav","totalTotal","cantidadDatos","i","length","newFecha","Date","format","newArrayDatosExcel","fechaDocumento","numeroFactura","nombreCliente","nombreTipoFactura","Producto","rut","IVA","total","parseInt","replace","console","log","largoExcel","exportaDataExcel","columns","xSteps","ySteps","datosExport","render","document","getElementById","filteredData","field","width","options","layout","pagination","paginationSize","movableColumns","persistence","sort","filter","persistenceID","ciudad"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport ReactDOM from 'react-dom';\r\nimport api from '../../config/Api';\r\nimport \"react-tabulator/lib/css/bootstrap/tabulator_bootstrap.min.css\";\r\nimport { React15Tabulator } from \"react-tabulator\";\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport ExcelDownload from './exportExcel';\r\n\r\n\r\nconst top100Films = [\r\n    { title: 'Ventas', codigo: 0, codigoCp : 'cpVentas' },\r\n    { title: 'Venta de productos por fecha', codigo: 1, codigoCp : 'cpVentaProductos'},\r\n    { title: 'Ventas del vendedor', codigo: 2, codigoCp : 'cpVentaVendedor'},\r\n    { title: 'Ventas del vendedor pagadas', codigo: 3, codigoCp : 'cpVentaVendedorPagadas'},\r\n    { title: 'Ventas del vendedor inpagadas', codigo: 4, codigoCp : 'cpVentaVendedorInpagadas'},\r\n    { title: 'Ventas por producto', codigo: 5, codigoCp : 'cpVentaProducto'},\r\n    { title: 'Comisiones pagadas', codigo: 6, codigoCp : 'cpComisionPagadas'},\r\n    { title: 'Resumen ventas', codigo: 6, codigoCp : 'cpResuemenVentas'}\r\n  ];\r\n\r\n\r\nconst data = [];\r\nclass ListaPagos extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.consultaVentasProducto = this.consultaVentasProducto.bind(this);\r\n    this.exExcelTes = this.exExcelTes.bind(this);\r\n    this.getOptionsSelect = this.getOptionsSelect.bind(this);\r\n    this.state = { \r\n        data: '',\r\n        inicio : null,\r\n        final : null,\r\n        dataSelect : [],\r\n        arrayIdProductos : []\r\n    }\r\n  }\r\n\r\n  change(e) {\r\n    this.setState({\r\n      [e.target.name]: e.target.value\r\n    });\r\n  }\r\n\r\n  //Cargamos los datos de la tabla.\r\n  componentDidMount(){\r\n      this.getProductos();\r\n  }\r\n\r\n  getProductos(){\r\n    axios.get(`${api}/api/producto`)\r\n    .then(res => {\r\n        //Validamos que el status de la respuesta de 200.\r\n        if(res.status === 200){\r\n            let data = res.data.producto;\r\n            this.setState({ dataSelect : data});\r\n        }\r\n    });\r\n  }\r\n\r\n  getOptionsSelect(e){\r\n    let idProductos = [];\r\n    e.forEach(element => {\r\n        idProductos.push(element.id);\r\n    });\r\n    this.setState({ arrayIdProductos : idProductos});\r\n  }\r\n\r\n  //Insertamos los datos.\r\n  consultaVentasProducto(){\r\n    let inicio = this.state.inicio;\r\n    let final = this.state.final;\r\n    let idProductos = this.state.arrayIdProductos;\r\n\r\n    //console.log(idProductos);\r\n    const data = 1\r\n    this.setState({ data });\r\n\r\n    //Realizamos la consulta con las fehcas\r\n    axios.post(`${api}/api/informes/ventasProductosFecha/${inicio}/${final}`)\r\n    .then(res => {\r\n        //Validamos que el status de la respuesta de 200.\r\n        if(res.status === 200){\r\n            let dataVentas = res.data.ventas;\r\n            let newArrayDatosGrilla = [];\r\n            let newArrayDatosExcel2 = [];\r\n\r\n            //Creamos los titulos.\r\n            let arrayTitulos = ['Fecha Documento','N Factura','Nombre Cliente','Tipo Factura', 'Producto','Codigo','Rut','Total Neto','IVA','Total'];\r\n            let totalNeto = 0;\r\n            let totalIvav  = 0;\r\n            let totalTotal = 0;\r\n            let cantidadDatos = 0;\r\n            for (let i = 0; i < dataVentas.length; i++) {\r\n\r\n              //Convertimos la fecha \r\n              let newFecha = new Date(dataVentas[i]['fechaDocumento']);\r\n              newFecha = moment(newFecha).format('DD/MM/YYYY');\r\n\r\n              let newArrayDatosExcel = [];\r\n\r\n              //Array para grilla\r\n              newArrayDatosGrilla.push({\r\n                \r\n                fechaDocumento : newFecha,\r\n                numeroFactura : dataVentas[i]['numeroFactura'],\r\n                nombreCliente : dataVentas[i]['nombreCliente'],\r\n                nombreTipoFactura : dataVentas[i]['nombreTipoFactura'],\r\n                Producto : dataVentas[i]['Producto'],\r\n                codigo : dataVentas[i]['codigo'],\r\n                rut : dataVentas[i]['rut'],\r\n                totalNeto : dataVentas[i]['totalNeto'],\r\n                IVA : dataVentas[i]['IVA'],\r\n                total : dataVentas[i]['total']\r\n              });\r\n              //array para excel.\r\n              newArrayDatosExcel.push(newFecha);\r\n              newArrayDatosExcel.push(dataVentas[i]['numeroFactura']);\r\n              newArrayDatosExcel.push(dataVentas[i]['nombreCliente']);\r\n              newArrayDatosExcel.push(dataVentas[i]['nombreTipoFactura']);\r\n              newArrayDatosExcel.push(dataVentas[i]['Producto']);\r\n              newArrayDatosExcel.push(dataVentas[i]['codigo']);\r\n              newArrayDatosExcel.push(dataVentas[i]['rut']);\r\n              newArrayDatosExcel.push(dataVentas[i]['totalNeto']);\r\n              newArrayDatosExcel.push(dataVentas[i]['IVA']);\r\n              newArrayDatosExcel.push(dataVentas[i]['total']);\r\n\r\n              totalNeto += parseInt((dataVentas[i]['totalNeto']).replace('$',''));\r\n              totalIvav += parseInt((dataVentas[i]['IVA']).replace('$',''));\r\n              totalTotal += parseInt((dataVentas[i]['total']).replace('$',''));\r\n              newArrayDatosExcel2.push(newArrayDatosExcel);\r\n            }\r\n            console.log(totalNeto);\r\n            console.log(totalIvav);\r\n            //Guardamos los datos para la grilla\r\n            this.setState({ data : newArrayDatosGrilla });\r\n\r\n            //Validamos que tenga datos.\r\n            //console.log(newArrayDatosExcel2.length);\r\n            let largoExcel = newArrayDatosExcel2.length;\r\n            console.log(largoExcel);\r\n            if(newArrayDatosExcel2.length >= 1){\r\n              //Guardamos los datos para exportacion de excel.\r\n              let exportaDataExcel = [{\r\n                columns: arrayTitulos,\r\n                data: newArrayDatosExcel2\r\n              },\r\n              {\r\n                  xSteps: 8,  //Columna\r\n                  ySteps: 0, //Lineo o posicion\r\n                  columns: [\"Total\", `${totalNeto}`, `${totalIvav}`, `${totalTotal}`]\r\n                }\r\n            ];\r\n              console.log(exportaDataExcel);\r\n              this.exExcelTes(exportaDataExcel, \"Ventas\");\r\n            }\r\n            \r\n        }else{\r\n            \r\n        }\r\n    })\r\n  }\r\n\r\n  exExcelTes(datosExport, name){\r\n    ReactDOM.render(\r\n      <ExcelDownload data={datosExport} nombreDocument={name}/>,\r\n      document.getElementById('callExcel')\r\n    );\r\n  }\r\n\r\n  \r\n  render() {\r\n\r\n    let filteredData = this.state.data;\r\n    let dataSelect = this.state.dataSelect;\r\n    //Agregamos las columnas a la tabla.\r\n    \r\n    const columns = [\r\n      { title: \"Fecha Documento\", field: \"fechaDocumento\", width: \"9%\"},\r\n      { title: \"N Factura\", field: \"numeroFactura\", width: \"15%\"},\r\n      { title: \"Nombre Cliente\", field: \"nombreCliente\", width: \"15%\"},\r\n      { title: \"Tipo Factura\", field: \"nombreTipoFactura\", width: \"15%\"},\r\n      { title: \"Producto\", field: \"Producto\", width: \"15%\"},\r\n      { title: \"Codigo\", field: \"codigo\", width: \"15%\"},\r\n      { title: \"Rut\", field: \"rut\", width: \"15%\"},\r\n      { title: \"Total Neto\", field: \"totalNeto\", width: \"15%\"},\r\n      { title: \"IVA\", field: \"IVA\", width: \"15%\"},\r\n      { title: \"Total\", field: \"total\", width: \"15%\"}\r\n    ];\r\n    \r\n    //Opciones de data table\r\n    const options = {\r\n      layout:\"id\",\r\n      width: \"100%\",\r\n      pagination:\"local\",\r\n      paginationSize:10,\r\n      movableColumns:true,\r\n      persistence:{\r\n        sort:true,\r\n        filter:true,\r\n        columns:true,\r\n      },\r\n      persistenceID:\"dataSave\"\r\n    };\r\n    return (\r\n        <div>\r\n            <div className = 'form-group'>\r\n                <div className = 'form-group'>\r\n                    <label>Fecha de Inico</label>\r\n                    <input onChange={e => this.change(e)} className= 'form-control' type = 'date' name='inicio' value= {this.state.ciudad}  />\r\n                </div>\r\n                <div className = 'form-group'>\r\n                    <label>Fecha de vencimiento</label>\r\n                    <input onChange={e => this.change(e)} className= 'form-control' type = 'date' name='final' value= {this.state.ciudad}  />\r\n                </div>\r\n                <div className = 'form-group'>\r\n                    <button type = 'button' onClick ={this.consultaVentasProducto} className = 'btn btn-primary'> Consultar </button>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <React15Tabulator columns={columns} data={filteredData} options={options}/>\r\n            </div>\r\n            <div id=\"callExcel\">\r\n              \r\n            </div>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ListaPagos;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}